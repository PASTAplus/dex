{% extends 'base.html' %}

{#{% block head %}#}
{#  <script>#}
{#const g = JSON/parse('{{ g_dict | safe | trim }}');#}
{#  </script>#}
{#{% endblock %}#}

{% block body %}

  <div class='root-page'>

    <h3>Welcome to the Dex test pages</h3>

    <div class='instructions'>
      <ul>
        <li>
          In most cases, Dex (this service) is used by opening a CSV file in the
          <a href='https://portal/edirepository/org/nis/home/jsp'>EDI Data Portal</a>
        </li>
      </ul>
    </div>

    <h3>Open CSV</h3>

    <div class='instructions'>
      <ul>
        <li>
          Open a CSV file if you already have its PASTA URL / identifier/
        </li>
      </ul>
    </div>

    <div class='widgets'>
      <form action='/' method='post'>
        <div class='form-group required'>
          <label class="control-label" for='open_url'>Data Entity URL for a CSV
            file to open</label>
          <input class="form-control" id='open_url' name='open_url'
                 width='80'
                 placeholder='https://pasta-d/lternet/edu/package/data/eml/knb-lter-ble/9/1/0be92831cb9e173a828416a954778598'/>
        </div>
        <div class='form-group required'>
          <button class="btn btn-primary" type='submit'>Open</button>
        </div>
      </form>
    </div>


    <h3>Open a CSV via data portal link</h3>

    <div class='instructions'>
      <ul>
        <li>
          Open a CSV via a random selection of data portal links/
        </li>
      </ul>
    </div>

  <div class='dex-space'>
    <ul>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fecotrends/509/1%2F226dda836d559f89a4634659cc60597c'>59cc60597c</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fecotrends/6654/2%2F14cd632a04bd093a0ec40a3fcc9d0acd>'>3fcc9d0acd</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fknb-lter-bnz/181/17%2Feeaa3f956962f2fa6e23c053ac7adf69'>53ac7adf69</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fecotrends/1199/2%2F7ef1f1b332b9a6c02eaaa417de15038e'>17de15038e</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fecotrends/4120/1%2Fd314040eb1409b9830df173b6dfd846e'>3b6dfd846e</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fknb-lter-bnz/628/7%2F992532120f5ebfa996c125149089d223'>149089d223</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fknb-lter-hfr/241/4%2F0ff1f16caf1fc22da692f514cb644dd3'>14cb644dd3</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fknb-lter-and/4547/5%2F289602fc029324b9ed3afac604f5e2d8'>c604f5e2d8</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fknb-lter-bnz/221/17%2F4cb57fe923dc7b49fcd7da2c8bb54582'>2c8bb54582</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fecotrends/6993/1%2F8d5915e70759b0024c1f02b23fa3b506'>b23fa3b506</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fknb-lter-mcr/5009/2%2Fc38369bf4ba726aeb8229ef7eebd5679'>f7eebd5679</a>
      </li>
      <li><a
          href='/https%3A%2F%2Fpasta-d.lternet.edu%2Fpackage%2Fdata%2Feml%2Fecotrends/5741/1%2Fce24b8c8bfcebce03fb1446baebd2278'>6baebd2278</a>
      </li>

    </ul>
    </ul>
  </div>

    <h3>Diagnostics and debugging</h3>

    <div class='instructions'>
      <ul>
        <li>
          Display debug information about the currently displayed CSV file/
        </li>
        <li>
          The debug information is displayed at the top of the page, just below the
          navigation bar/
        </li>
      </ul>
    </div>


    <h3>Open a sample CSV</h3>

    <div class='instructions'>
      <ul>
        <li>
          Open a randomly selected CSV document for testing or demonstration of Dex
        </li>
      </ul>
    </div>

    {#<div class='dex-space'>#}
    <div class='widgets'>
      <table class='sample-csv-list'>
        <th>Size (bytes)</th>
        <th>Scope</th>
        <th>Identity</th>
        <th>Version</th>
        <th>Entity</th>
        <th>Open in Dex</th>
        {% for csv_dict in csv_list %}
          <tr>
            <td class='right'>
              {{ '{:,}'.format(csv_dict.size) }}
            </td>
            <td>
              {{ csv_dict.scope_str }}
            </td>
            <td>
              {{ csv_dict.id_str }}
            </td>
            <td>
              {{ csv_dict.ver_str }}
            </td>
            <td class='mono'>
              {{ csv_dict.entity_str }}
            </td>
            <td>
              {% set pkd_id = [
                'https://pasta-d.lternet.edu/package/data/eml',
                csv_dict.scope_str,
                csv_dict.id_str,
                csv_dict.ver_str,
                csv_dict.entity_str
                ] | join('/') %}
              {#<a href='/sample/{{ pkd_id | urlencode | replace("/", "%2F") }}'>open</a>#}
              <a href='/sample/{{ pkd_id }}'>open</a>
            </td>
            <td>
              {{ csv_dict.status }}
            </td>
          </tr>
        {% endfor %}
      </table>
    </div>
  </div>

{% endblock %}

{% block scripts %}
{% endblock %}
